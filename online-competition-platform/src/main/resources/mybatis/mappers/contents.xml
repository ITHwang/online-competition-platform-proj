<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace = "mappers.contents">
	<resultMap id="ContentsResult" type="contentsVO">
		<result property = "contents_id" column = "contents_id" />
		<result property = "mem_id" column = "mem_id" />
		<result property = "compet_id" column = "compet_id" />
		<result property = "contents_state" column = "contents_state" />
		<result property = "contents_processing_date" column = "contents_processing_date" />
		<result property = "contents_reject_reason" column = "contents_reject_reason" />
		<result property = "contents_view" column = "contents_view" />
		<result property = "contents_name" column = "contents_name" />
	</resultMap>
	
	<select id="selectContentsList" resultMap="ContentsResult" parameterType="int">
  	<![CDATA[
				select contents_id, mem_id, compet_id, contents_state, 
					   to_char(contents_processing_date, 'yyyy-mm-dd') as contents_processing_date,
					   contents_reject_reason, contents_view, contents_name
				from contents
				where contents_state = '제출완료' and compet_id = #{compet_id}
   	]]>
	</select>
	
	<select id="selectApprContentsList" resultMap="ContentsResult" parameterType="int">
  	<![CDATA[
				select contents_id, mem_id, compet_id, contents_state, 
					   to_char(contents_processing_date, 'yyyy-mm-dd') as contents_processing_date,
					   contents_reject_reason, contents_view, contents_name
				from contents
				where contents_state = '승인' and compet_id = #{compet_id}
   	]]>
	</select>
	
	<update id="updateApprContents" parameterType="int">
	<![CDATA[
				update contents
				set contents_state = '승인', contents_processing_date = sysdate
				where contents_id = #{contents_id}
	]]>
	</update>
	
</mapper>